WITH hlw AS (
    SELECT 
        c.name AS customer_name,
        SUM(o.total_amount) AS total_spent
    FROM customers c
    JOIN orders o 
        ON c.customer_id = o.customer_id
    WHERE c.city = 'Delhi'
    GROUP BY c.name
    HAVING SUM(o.total_amount) > 600
)
SELECT * 
FROM hlw;
